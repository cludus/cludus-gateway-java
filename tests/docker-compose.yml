version: "3.9"

services:
#  gateway-load-test:
#    image: grafana/k6
#    volumes:
#      - ./k6index.js:/k6index.js
#    command: run /k6index.js
#    deploy:
#      mode: replicated
#      replicas: 5
#      resources:
#        limits:
#          cpus: '3'
#          memory: 8gb

  proxy:
    hostname: proxy.cludus.local
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./haproxy.cfg:/usr/local/etc/haproxy/haproxy.cfg
    image: haproxy:2.8

  prometheus:
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    image: prom/prometheus:latest